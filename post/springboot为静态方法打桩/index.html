<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SpringBoot为静态方法打桩 | Hanwen Tong</title>
<meta name="keywords" content="Spring Boot" />
<meta name="description" content="Spring Boot对静态方法进行打桩 问题 在对Spring Boot项目进行测试的时候，会对业务逻辑service层进行测试。而service层的代码可">
<meta name="author" content="Hanwen Tong">
<link rel="canonical" href="https://haventong.github.io/post/springboot%E4%B8%BA%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E6%89%93%E6%A1%A9/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css" integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://haventong.github.io/img/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://haventong.github.io/img/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://haventong.github.io/img/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://haventong.github.io/img/apple-touch-icon.png">
<link rel="mask-icon" href="https://haventong.github.io/img/android-chrome-192x192.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="SpringBoot为静态方法打桩" />
<meta property="og:description" content="Spring Boot对静态方法进行打桩 问题 在对Spring Boot项目进行测试的时候，会对业务逻辑service层进行测试。而service层的代码可" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://haventong.github.io/post/springboot%E4%B8%BA%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E6%89%93%E6%A1%A9/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-03-18T10:05:43&#43;08:00" />
<meta property="article:modified_time" content="2022-03-18T10:05:43&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SpringBoot为静态方法打桩"/>
<meta name="twitter:description" content="Spring Boot对静态方法进行打桩 问题 在对Spring Boot项目进行测试的时候，会对业务逻辑service层进行测试。而service层的代码可"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://haventong.github.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "SpringBoot为静态方法打桩",
      "item": "https://haventong.github.io/post/springboot%E4%B8%BA%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E6%89%93%E6%A1%A9/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SpringBoot为静态方法打桩",
  "name": "SpringBoot为静态方法打桩",
  "description": "Spring Boot对静态方法进行打桩 问题 在对Spring Boot项目进行测试的时候，会对业务逻辑service层进行测试。而service层的代码可",
  "keywords": [
    "Spring Boot"
  ],
  "articleBody": "Spring Boot对静态方法进行打桩 问题 在对Spring Boot项目进行测试的时候，会对业务逻辑service层进行测试。而service层的代码可能会使用util中的工具类，而工具方法通常来说都是static类型的方法。问题在于，当对service层的代码进行测试时，我们往往需要对静态方法打桩，返回我们需要的结果。然而，主流的测试框架Mockito并不支持对静态方法的打桩。对于此问题，我们需要寻求其他框架的解决方案\n解决 1. 首先，通过mockito官方文档的描述，可以发现：\n What are the limitations of Mockito\n Cannot mock final classes Cannot mock static methods Cannot mock final methods - their real behavior is executed without any exception. Mockito cannot warn you about mocking final methods so be vigilant.   可以看到，Mockito并不支持mock静态方法，同时也有以下的描述：\n Can I mock static methods?\nNo. Mockito prefers object orientation and dependency injection over static, procedural code that is hard to understand \u0026 change. If you deal with scary legacy code you can use JMockit or Powermock to mock static methods.\n 通过这样的描述，我们发现其他框架提供了解决方案：\n JMockit Powermock  之后，由于网上的回答中，Powermock更加主流，且与Mockito的语法相近，于是考虑通过Powermock框架解决问题。\n再次查阅了Powermock在github上的项目主页：，得到以下的说明：\n urrently PowerMock supports JUnit and TestNG. There are three different JUnit test executors available, one for JUnit 4.4-4.12, one for JUnit 4.0-4.3. The test executor for JUnit 3 is not avaliable since PowerMock 2.0.\n 可以看出，Powermock当前最新版本仅支持到JUnit4.12，而无法对JUnit5提供支持。然而，spring-boot-starter-test中，整合的已是JUnit5. 在网上找寻了众多的回答，所有的例子都是通过JUnit4编写的测试脚本。\n且通过Powermock测试的脚本结构如下：\n1 2 3 4 5  @RunWith(PowerMockRunner.class) @PrepareForTest( { YourClassWithEgStaticMethod.class }) public class YourTestCase { ... }   该结构为JUnit4的写法，并不能在JUnit5中使用。我也尝试强行在Spring Boot项目中单独添加JUnit4依赖，然后单独通过JUnit4来运行通过Powermock编写的测试脚本，多次尝试之后依然无法运行。于是转向另一个框架–JMockit。\n2. 尝试通过JMockit来测试静态方法。首先查看JMockit是否支持JUnit5，在官网寻找到了答案：\n To run tests that use any of the JMockit APIs, use your Java IDE, Maven/Gradle build script, etc. the way you normally would. In principle, any JDK of version 1.7 or newer, on Windows, Mac OS X, or Linux, can be used. JMockit supports (and requires) the use of JUnit (version 4 or 5) or TestNG\n 既然JMockit支持JUnit5，且可以对静态方法进行打桩，这就是一种可行的解决方案。所以接下来我就去寻找对静态方法进行打桩的实现方案。\n在一篇博客中，我发现了解决方案：\n  首先，需要添加JMockit的依赖，通过mvnrepository添加最新版的JMockit依赖：\n1 2 3 4 5 6 7    org.jmockit jmockit 1.48 test      查看博客中给出的例子：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  // 需要测试的类 public class AppManager { public boolean managerResponse(String question) { return AppManager.isResponsePositive(question); } public static boolean isResponsePositive(String value) { if (value == null) { return false; } int length = value.length(); int randomNumber = randomNumber(); return length == randomNumber ? true : false; } private static int randomNumber() { return new Random().nextInt(7); } } // 对静态方法进行打桩 @Test public void givenAppManager_whenStaticMethodCalled_thenValidateExpectedResponse() { new MockUpAppManager() { @Mock public boolean isResponsePositive(String value) { return false; } }; assertFalse(appManager.managerResponse(\"Some string...\")); }     按照类似的写法，完成了我的测试脚本的编写\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  @Test @DisplayName(\"发送邮件内容正确\") void shouldSendCorrectEmailWhenUserIsNew(){ // 使用JMockit对静态方法进行打桩  new MockUpCheckCodeUtil(){ @mockit.Mock public String generateCheckCode(){ return \"123456\"; } }; when(redisTemplate.opsForValue()).thenReturn(new ValueOperationsFake()); ArgumentCaptorString emailCaptor = ArgumentCaptor.forClass(String.class); ArgumentCaptorString subjectCaptor = ArgumentCaptor.forClass(String.class); ArgumentCaptorString contentCaptor = ArgumentCaptor.forClass(String.class); customerService.sendCheckCode(\"10175101152@stu.ecnu.edu.cn\"); verify(mailService, times(1)) .sendHtmlMail(emailCaptor.capture(), subjectCaptor.capture(), contentCaptor.capture()); assertAll( () - assertEquals(\"10175101152@stu.ecnu.edu.cn\", emailCaptor.getValue()), () - assertEquals(\"Registration from MeetHere\", subjectCaptor.getValue()), () - assertEquals(\"Welcome to MeetHere!Your check code is \" + \"123456\" + \"\n\", contentCaptor.getValue()) ); }     编写完毕后，尝试是否可以运行，但是依然报错：\n1  java.lang.IllegalStateException: JMockit didn't get initialized; please check the -javaagent JVM initialization parameter was used   针对报错信息去Google进行查找，大多数的解决方案是：\n1  @RunWith(JMockit.class)   这同样是JUnit4的写法。并不能解决我所遇到的问题\n  再次回到JMockit的官方文档，查看官方文档中给出的运行方法，发现了潜在的解决方案：\n JMockit also requires the -javaagent JVM initialization parameter to be used; when using the Maven Surefire plugin for test execution, it’s specified as follows:\n 所以看来想要运行JMockito编写的测试脚本，需要指定-javaagent的JVM参数才可以。\n官网给出了方案：\n1 2 3 4 5 6 7 8 9 10 11    maven-surefire-plugin 2.22.2    -javaagent:${settings.localRepository}/org/jmockit/jmockit/${jmockit.version}/jmockit-${jmockit.version}.jar       将这段xml复制到pom文件中，并将${jmockit.version}替换为项目中使用的1.48\n  再次运行测试脚本：\n BINGO!\n  ",
  "wordCount" : "1654",
  "inLanguage": "en",
  "datePublished": "2022-03-18T10:05:43+08:00",
  "dateModified": "2022-03-18T10:05:43+08:00",
  "author":{
    "@type": "Person",
    "name": "Hanwen Tong"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://haventong.github.io/post/springboot%E4%B8%BA%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E6%89%93%E6%A1%A9/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Hanwen Tong",
    "logo": {
      "@type": "ImageObject",
      "url": "https://haventong.github.io/img/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://haventong.github.io" accesskey="h" title="Hanwen Tong (Alt + H)">Hanwen Tong</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://haventong.github.io/archives" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://haventong.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://haventong.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://haventong.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://haventong.github.io">Home</a>&nbsp;»&nbsp;<a href="https://haventong.github.io/post/">Posts</a></div>
    <h1 class="post-title">
      SpringBoot为静态方法打桩
    </h1>
    <div class="post-meta"><span title='2022-03-18 10:05:43 +0800 CST'>March 18, 2022</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Hanwen Tong

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#spring-boot%e5%af%b9%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e8%bf%9b%e8%a1%8c%e6%89%93%e6%a1%a9" aria-label="Spring Boot对静态方法进行打桩">Spring Boot对静态方法进行打桩</a><ul>
                        <ul>
                        
                <li>
                    <a href="#%e9%97%ae%e9%a2%98" aria-label="问题">问题</a></li>
                <li>
                    <a href="#%e8%a7%a3%e5%86%b3" aria-label="解决">解决</a><ul>
                        
                <li>
                    <a href="#1" aria-label="1.">1.</a></li>
                <li>
                    <a href="#2" aria-label="2.">2.</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="spring-boot对静态方法进行打桩">Spring Boot对静态方法进行打桩<a hidden class="anchor" aria-hidden="true" href="#spring-boot对静态方法进行打桩">#</a></h1>
<h3 id="问题">问题<a hidden class="anchor" aria-hidden="true" href="#问题">#</a></h3>
<p>在对Spring Boot项目进行测试的时候，会对业务逻辑service层进行测试。而service层的代码可能会使用util中的工具类，而工具方法通常来说都是static类型的方法。问题在于，当对service层的代码进行测试时，我们往往需要对静态方法打桩，返回我们需要的结果。然而，主流的测试框架Mockito并不支持对静态方法的打桩。对于此问题，我们需要寻求其他框架的解决方案</p>
<h3 id="解决">解决<a hidden class="anchor" aria-hidden="true" href="#解决">#</a></h3>
<h4 id="1">1.<a hidden class="anchor" aria-hidden="true" href="#1">#</a></h4>
<p>首先，通过mockito官方文档<a href="https://github.com/mockito/mockito/wiki/FAQ"></a>的描述，可以发现：</p>
<blockquote>
<p>What are the limitations of Mockito</p>
<ul>
<li>Cannot mock final classes</li>
<li>Cannot mock static methods</li>
<li>Cannot mock final methods - their real behavior is executed without any exception.</li>
<li>Mockito cannot warn you about mocking final methods so be vigilant.</li>
</ul>
</blockquote>
<p>可以看到，Mockito并不支持mock静态方法，同时也有以下的描述：</p>
<blockquote>
<p>Can I mock static methods?</p>
<p>No. Mockito prefers object orientation and dependency injection over static, procedural code that is hard to understand &amp; change. If you deal with scary legacy code you can use <strong>JMockit</strong> or <strong>Powermock</strong> to mock static methods.</p>
</blockquote>
<p>通过这样的描述，我们发现其他框架提供了解决方案：</p>
<ul>
<li>JMockit</li>
<li>Powermock</li>
</ul>
<p>之后，由于网上的回答中，Powermock更加主流，且与Mockito的语法相近，于是考虑通过Powermock框架解决问题。</p>
<p>再次查阅了Powermock在github上的项目主页：<a href="https://github.com/powermock/powermock/wiki/Getting-Started"></a>，得到以下的说明：</p>
<blockquote>
<p>urrently PowerMock supports JUnit and <a href="https://github.com/powermock/powermock/wiki/TestNG">TestNG</a>. There are three different JUnit test executors available, one for <strong>JUnit 4.4-4.12</strong>, one for JUnit 4.0-4.3. The test executor for JUnit 3 is not avaliable since PowerMock 2.0.</p>
</blockquote>
<p>可以看出，Powermock当前最新版本仅支持到JUnit4.12，而无法对JUnit5提供支持。然而，spring-boot-starter-test中，整合的已是JUnit5. 在网上找寻了众多的回答，所有的例子都是通过JUnit4编写的测试脚本。</p>
<p>且通过Powermock测试的脚本结构如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">PowerMockRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@PrepareForTest</span><span class="o">(</span> <span class="o">{</span> <span class="n">YourClassWithEgStaticMethod</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">YourTestCase</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>该结构为JUnit4的写法，并不能在JUnit5中使用。我也尝试强行在Spring Boot项目中单独添加JUnit4依赖，然后单独通过JUnit4来运行通过Powermock编写的测试脚本，多次尝试之后依然无法运行。于是转向另一个框架&ndash;JMockit。</p>
<h4 id="2">2.<a hidden class="anchor" aria-hidden="true" href="#2">#</a></h4>
<p>尝试通过JMockit来测试静态方法。首先查看JMockit是否支持JUnit5，在官网<a href="https://jmockit.github.io/tutorial/Introduction.html#runningTests"></a>寻找到了答案：</p>
<blockquote>
<p>To run tests that use any of the JMockit APIs, use your Java IDE, Maven/Gradle build script, etc. the way you normally would. In principle, any JDK of version <strong>1.7</strong> or newer, on Windows, Mac OS X, or Linux, can be used. JMockit supports (and requires) the use of <strong>JUnit (version 4 or 5)</strong> or TestNG</p>
</blockquote>
<p>既然JMockit支持JUnit5，且可以对静态方法进行打桩，这就是一种可行的解决方案。所以接下来我就去寻找对静态方法进行打桩的实现方案。</p>
<p>在一篇博客中，我发现了解决方案：</p>
<ul>
<li>
<p>首先，需要添加JMockit的依赖，通过mvnrepository添加最新版的JMockit依赖：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"> <span class="c">&lt;!-- https://mvnrepository.com/artifact/org.jmockit/jmockit --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.jmockit<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jmockit<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>1.48<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看博客中给出的例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 需要测试的类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppManager</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">managerResponse</span><span class="o">(</span><span class="n">String</span> <span class="n">question</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">AppManager</span><span class="o">.</span><span class="na">isResponsePositive</span><span class="o">(</span><span class="n">question</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isResponsePositive</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">randomNumber</span> <span class="o">=</span> <span class="n">randomNumber</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">length</span> <span class="o">==</span> <span class="n">randomNumber</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">randomNumber</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">7</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 对静态方法进行打桩
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">givenAppManager_whenStaticMethodCalled_thenValidateExpectedResponse</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="n">MockUp</span><span class="o">&lt;</span><span class="n">AppManager</span><span class="o">&gt;()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Mock</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isResponsePositive</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assertFalse</span><span class="o">(</span><span class="n">appManager</span><span class="o">.</span><span class="na">managerResponse</span><span class="o">(</span><span class="s">&#34;Some string...&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>按照类似的写法，完成了我的测试脚本的编写</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">&#34;发送邮件内容正确&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">shouldSendCorrectEmailWhenUserIsNew</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 使用JMockit对静态方法进行打桩
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">new</span> <span class="n">MockUp</span><span class="o">&lt;</span><span class="n">CheckCodeUtil</span><span class="o">&gt;(){</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@mockit.Mock</span>
</span></span><span class="line"><span class="cl">      <span class="kd">public</span> <span class="n">String</span> <span class="nf">generateCheckCode</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">      	<span class="k">return</span> <span class="s">&#34;123456&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    	<span class="o">}</span>
</span></span><span class="line"><span class="cl">   <span class="o">};</span>
</span></span><span class="line"><span class="cl">  <span class="n">when</span><span class="o">(</span><span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">()).</span><span class="na">thenReturn</span><span class="o">(</span><span class="k">new</span> <span class="n">ValueOperationsFake</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">ArgumentCaptor</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">emailCaptor</span> <span class="o">=</span> <span class="n">ArgumentCaptor</span><span class="o">.</span><span class="na">forClass</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">ArgumentCaptor</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">subjectCaptor</span> <span class="o">=</span> <span class="n">ArgumentCaptor</span><span class="o">.</span><span class="na">forClass</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">ArgumentCaptor</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">contentCaptor</span> <span class="o">=</span> <span class="n">ArgumentCaptor</span><span class="o">.</span><span class="na">forClass</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">customerService</span><span class="o">.</span><span class="na">sendCheckCode</span><span class="o">(</span><span class="s">&#34;10175101152@stu.ecnu.edu.cn&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">verify</span><span class="o">(</span><span class="n">mailService</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="n">1</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">sendHtmlMail</span><span class="o">(</span><span class="n">emailCaptor</span><span class="o">.</span><span class="na">capture</span><span class="o">(),</span> <span class="n">subjectCaptor</span><span class="o">.</span><span class="na">capture</span><span class="o">(),</span> 			<span class="n">contentCaptor</span><span class="o">.</span><span class="na">capture</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">assertAll</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="s">&#34;10175101152@stu.ecnu.edu.cn&#34;</span><span class="o">,</span> <span class="n">emailCaptor</span><span class="o">.</span><span class="na">getValue</span><span class="o">()),</span>
</span></span><span class="line"><span class="cl">                <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="s">&#34;Registration from MeetHere&#34;</span><span class="o">,</span> <span class="n">subjectCaptor</span><span class="o">.</span><span class="na">getValue</span><span class="o">()),</span>
</span></span><span class="line"><span class="cl">                <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="s">&#34;&lt;h1&gt;Welcome to MeetHere!&lt;/h1&gt;&lt;p&gt;Your check code is &lt;u&gt;&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;123456&#34;</span> <span class="o">+</span> <span class="s">&#34;&lt;/u&gt;&lt;/p&gt;&#34;</span><span class="o">,</span> <span class="n">contentCaptor</span><span class="o">.</span><span class="na">getValue</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">        <span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>编写完毕后，尝试是否可以运行，但是依然报错：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalStateException</span><span class="o">:</span> <span class="n">JMockit</span> <span class="n">didn</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">get</span> <span class="n">initialized</span><span class="o">;</span> <span class="n">please</span> <span class="n">check</span> <span class="n">the</span> <span class="o">-</span><span class="n">javaagent</span> <span class="n">JVM</span> <span class="n">initialization</span> <span class="n">parameter</span> <span class="n">was</span> <span class="n">used</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>针对报错信息去Google进行查找，大多数的解决方案是：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">JMockit</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这同样是JUnit4的写法。并不能解决我所遇到的问题</p>
</li>
<li>
<p>再次回到JMockit的官方文档，查看官方文档中给出的运行方法，发现了潜在的解决方案：</p>
<blockquote>
<p>JMockit also requires the <code>-javaagent</code> JVM initialization parameter to be used; when using the <strong>Maven Surefire</strong> plugin for test execution, it&rsquo;s specified as follows:</p>
</blockquote>
<p>所以看来想要运行JMockito编写的测试脚本，需要指定<code>-javaagent</code>的JVM参数才可以。</p>
<p>官网给出了方案：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!-- or some other version --&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&lt;argLine&gt;</span>
</span></span><span class="line"><span class="cl">            -javaagent:${settings.localRepository}/org/jmockit/jmockit/${jmockit.version}/jmockit-${jmockit.version}.jar
</span></span><span class="line"><span class="cl">         <span class="nt">&lt;/argLine&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/plugins&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>将这段xml复制到pom文件中，并将<code>${jmockit.version}</code>替换为项目中使用的<code>1.48</code></p>
</li>
<li>
<p>再次运行测试脚本：</p>
  <div align="center"><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1g9rsjdzew8j30j006o759.jpg" alt="屏幕快照 2019-12-10 下午6.12.39" style="zoom:50%;" /></div>
<p><strong>BINGO!</strong></p>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://haventong.github.io/tags/spring-boot/">Spring Boot</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://haventong.github.io/post/validation-api/">
    <span class="title">« Prev Page</span>
    <br>
    <span>validation-api</span>
  </a>
  <a class="next" href="https://haventong.github.io/post/redis%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%8A%E5%BC%80%E5%85%B3/">
    <span class="title">Next Page »</span>
    <br>
    <span>redis基本配置及开关</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share SpringBoot为静态方法打桩 on twitter"
        href="https://twitter.com/intent/tweet/?text=SpringBoot%e4%b8%ba%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e6%89%93%e6%a1%a9&amp;url=https%3a%2f%2fhaventong.github.io%2fpost%2fspringboot%25E4%25B8%25BA%25E9%259D%2599%25E6%2580%2581%25E6%2596%25B9%25E6%25B3%2595%25E6%2589%2593%25E6%25A1%25A9%2f&amp;hashtags=SpringBoot">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share SpringBoot为静态方法打桩 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhaventong.github.io%2fpost%2fspringboot%25E4%25B8%25BA%25E9%259D%2599%25E6%2580%2581%25E6%2596%25B9%25E6%25B3%2595%25E6%2589%2593%25E6%25A1%25A9%2f&amp;title=SpringBoot%e4%b8%ba%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e6%89%93%e6%a1%a9&amp;summary=SpringBoot%e4%b8%ba%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e6%89%93%e6%a1%a9&amp;source=https%3a%2f%2fhaventong.github.io%2fpost%2fspringboot%25E4%25B8%25BA%25E9%259D%2599%25E6%2580%2581%25E6%2596%25B9%25E6%25B3%2595%25E6%2589%2593%25E6%25A1%25A9%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share SpringBoot为静态方法打桩 on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fhaventong.github.io%2fpost%2fspringboot%25E4%25B8%25BA%25E9%259D%2599%25E6%2580%2581%25E6%2596%25B9%25E6%25B3%2595%25E6%2589%2593%25E6%25A1%25A9%2f&title=SpringBoot%e4%b8%ba%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e6%89%93%e6%a1%a9">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share SpringBoot为静态方法打桩 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhaventong.github.io%2fpost%2fspringboot%25E4%25B8%25BA%25E9%259D%2599%25E6%2580%2581%25E6%2596%25B9%25E6%25B3%2595%25E6%2589%2593%25E6%25A1%25A9%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share SpringBoot为静态方法打桩 on whatsapp"
        href="https://api.whatsapp.com/send?text=SpringBoot%e4%b8%ba%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e6%89%93%e6%a1%a9%20-%20https%3a%2f%2fhaventong.github.io%2fpost%2fspringboot%25E4%25B8%25BA%25E9%259D%2599%25E6%2580%2581%25E6%2596%25B9%25E6%25B3%2595%25E6%2589%2593%25E6%25A1%25A9%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share SpringBoot为静态方法打桩 on telegram"
        href="https://telegram.me/share/url?text=SpringBoot%e4%b8%ba%e9%9d%99%e6%80%81%e6%96%b9%e6%b3%95%e6%89%93%e6%a1%a9&amp;url=https%3a%2f%2fhaventong.github.io%2fpost%2fspringboot%25E4%25B8%25BA%25E9%259D%2599%25E6%2580%2581%25E6%2596%25B9%25E6%25B3%2595%25E6%2589%2593%25E6%25A1%25A9%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://haventong.github.io">Hanwen Tong</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
